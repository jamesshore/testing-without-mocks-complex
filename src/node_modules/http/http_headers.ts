// Copyright Titanium I.T. LLC.

// The TypeScript definitions for Node (@types/node) thinks the type of the Node request headers
// is (string | string[] | undefined). But that doesn't match the Node.js documentation (found at
// https://nodejs.org/dist/latest-v18.x/docs/api/http.html#class-httpincomingmessage ).
// According to that documentation, the header is always a string, except for the 'set-cookie'
// header, which is always a string array.
//
// I'm not sure why the official type definition is different. They extend NodeJS.Dict, which adds
// "| undefined" to property values, and I think that's the source of the problem. Maybe that's in
// support of a use case I don't have, or maybe it's an oversight. Either way, I don't think
// undefined is possible in my code, and having it in the type definition causes all sorts of problems.
//
// Therefore, I have defined my own type to be used in place of http.IncomingHttpHeaders:
export type NodeIncomingHttpHeaders = { "set-cookie"?: string[] } & Record<string, string>;

// The rest of our code uses a much more sensible header scheme: one key, one required value.
export type HttpHeader = string;
export type HttpHeaders = Record<string, HttpHeader>;